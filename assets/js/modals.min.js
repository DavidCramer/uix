!function(t){var e,o,i,a=null,n={},d=[],s=[],l=function(){if(d.length||s.length){var t=d.length?d[d.length-1]:s[s.length-1],l=i.width(),r=i.height(),c=n[t].config.height,m=c,f=n[t].config.width,p=!1,g=!1;if(n[t].body.css({height:""}),a&&e.addClass("has-uix-modal"),"string"==typeof f&&(f=parseInt(f),f=l/100*parseInt(f)),"string"==typeof c&&(c=parseInt(c),c=r/100*parseInt(c)),(r-c)/2.2<0&&0,c+2*n[t].config.padding>r&&a&&(c=r,m="100%",a&&a.css({}),g=!0),f+2*n[t].config.padding>=l&&(f="100%",a&&a.css({}),g=!0),!0===g&&(l<=700&&l>600?(a&&(c=r-2*n[t].config.padding),f=l,m=c-2*n[t].config.padding,f="100%",0,a&&a.css({padding:n[t].config.padding})):l<=600&&(a&&(c=r),f=l,m="100%",0,a&&a.css({padding:0}))),a&&a.is(":hidden")&&(p=!0,a.show()),n[t].header&&(a&&a.show(),c-=n[t].header.outerHeight(),n[t].closer.css({padding:n[t].header.outerHeight()/2-3.8}),n[t].title.css({paddingRight:n[t].closer.outerWidth()})),n[t].footer&&(a&&a.show(),c-=n[t].footer.outerHeight()),a&&!0===p&&(a.hide(),p=!1),c!=m&&n[t].body.css({height:c}),n[t].modal.css({width:f}),n[t].config.sticky&&n[t].config.minimized){var u={},h=n[t].title.outerHeight()-n[t].modal.outerHeight();n[t].config.sticky.indexOf("bottom")>-1?u["margin-bottom"]=h:n[t].config.sticky.indexOf("top")>-1&&(u["margin-top"]=h),n[t].modal.css(u),n[t].config.sticky.length>=3&&(o.css("margin-"+n[t].config.sticky[0],n[t].title.outerHeight()),g?n[t].modal.css(n[t].config.sticky[1],0):n[t].modal.css(n[t].config.sticky[1],parseFloat(n[t].config.sticky[2])))}return a&&(a.fadeIn(n[t].config.speed),n[t].modal.css({top:"calc( 50% - "+n[t].modal.outerHeight()/2+"px)",left:"calc( 50% - "+n[t].modal.outerWidth()/2+"px)"}),setTimeout(function(){n[t].modal.addClass("uix-animate")},10)),n}},r=function(o){if(d.length)if(o?d.splice(o.indexOf(d),1):o=d.pop(),n[o].modal.hasClass("uix-animate")&&!d.length)n[o].modal.removeClass("uix-animate"),setTimeout(function(){var t=n[o];t.modal.fadeOut(200,function(){t.modal.remove()}),n[o].flush&&delete n[o]},500);else if(a){var i=n[o];i.modal.fadeOut(200,function(){i.modal.remove()}),n[o].flush&&delete n[o]}d.length?(n[d[d.length-1]].modal.find(".uix-modal-blocker").remove(),n[d[d.length-1]].modal.animate({opacity:1},100)):(a&&a.fadeOut(250,function(){t(this).remove(),a=null}),e.removeClass("has-uix-modal"),t(window).trigger("modals.closed")),t(window).trigger("modal.close")};t.uixModal=function(c,m){e=t("html"),o=t("body"),i=t(window);var f=t.extend(!0,{element:"form",height:550,width:620,padding:12,speed:250,content:""},c);f.trigger=m,a||f.sticky||(a=t("<div>",{class:"uix-backdrop"}),o.append(a),a.hide());var p=f.element,g=f.modal;void 0===n[g]?(f.sticky&&(f.sticky=f.sticky.split(" "),f.sticky.length<2&&(f.sticky=null),s.push(g)),n[g]={config:f},n[g].body=t("<div>",{class:"uix-modal-body",id:g+"_uixModalBody"}),n[g].content=t("<div>",{class:"uix-modal-content",id:g+"_uixModalContent"})):n[g].config=f;var u={id:g+"_uixModal",tabIndex:-1,"ariaLabelled-by":g+"_uixModalLable",method:"post",enctype:"multipart/form-data",class:"uix-modal-wrap "+(f.sticky?" uix-sticky-modal "+f.sticky[0]+"-"+f.sticky[1]:"")};if(c.config&&t.extend(u,c.config),n[g].modal=t("<"+p+">",u),f.sticky||d.push(g),f.animate&&a){var h=f.animate.split(" "),w=f.speed+"ms",y=f.animateEase?f.animateEase:"ease";1===h.length&&(h[1]=0),n[g].modal.css({transform:"translate("+h[0]+", "+h[1]+")","-web-kit-transition":"transform "+w+" "+y,"-moz-transition":"transform "+w+" "+y,transition:"transform "+w+" "+y})}if(n[g].content.css({}),n[g].body.append(n[g].content).appendTo(n[g].modal),a?a.append(n[g].modal):n[g].modal.appendTo(t("body")),f.footer){if(!n[g].footer)if(n[g].footer=t("<div>",{class:"uix-modal-footer",id:g+"_uixModalFooter"}),n[g].footer.css({padding:f.padding}),"function"==typeof window[f.footer])n[g].footer.append(window[f.footer](f,n[g]));else if("string"==typeof f.footer)try{var x=t(f.footer);n[g].footer.html(x.html())}catch(t){n[g].footer.html(f.footer)}n[g].footer.appendTo(n[g].modal)}if(f.title){var v="prependTo";n[g].header=t("<div>",{class:"uix-modal-title",id:g+"_uixModalTitle"}),n[g].closer=t("<a>",{href:"#close",class:"uix-modal-closer","data-dismiss":"modal","aria-hidden":"true",id:g+"_uixModalCloser"}).html("&times;"),n[g].title=t("<h3>",{class:"modal-label",id:g+"_uixModalLable"}),n[g].title.html(f.title).appendTo(n[g].header),n[g].title.css({padding:f.padding}),n[g].title.append(n[g].closer),n[g].config.sticky?(n[g].config.minimized&&!0!==n[g].config.minimized&&(setTimeout(function(){n[g].title.trigger("click")},parseInt(n[g].config.minimized)),n[g].config.minimized=!1),n[g].closer.hide(),n[g].title.addClass("uix-modal-closer").data("modal",g).appendTo(n[g].header),n[g].config.sticky.indexOf("top")>-1&&(v="appendTo")):n[g].closer.data("modal",g).appendTo(n[g].header),n[g].header[v](n[g].modal)}if(n[g].modal.outerWidth(f.width),f.content&&!n[g].content.children().length){if("function"==typeof f.content)n[g].content.append(f.content(f,n[g]));else if("string"==typeof f.content)if("function"==typeof window[f.content])n[g].content.html(window[f.content](f));else try{var b=t(f.content);if(!b.length)throw new Error;n[g].content.append(b.html()),b.show(),n[g].modal.removeClass("processing")}catch(e){n[g].footer.hide(),setTimeout(function(){n[g].modal.addClass("processing"),t.post(f.content,m.data(),function(t){n[g].content.html(t),n[g].modal.removeClass("processing"),n[g].footer.show()})},250)}}else n[g].modal.removeClass("processing");d.length>1&&d[d.length-2]!==g&&(n[d[d.length-2]].modal.prepend('<div class="uix-modal-blocker"></div>').animate({opacity:1},100),n[g].modal.hide().fadeIn(200)),l(),t(window).trigger("modal.open"),c.master&&d&&delete n[d.shift()],n[g].positionModals=l,n[g].closeModal=function(){r(g)};var k=n[g].modal.find('button[type="submit"]');k.length?n[g].flush=!0:n[g].modal.find("input").on("change",function(){n[g].modal.submit()});var D=t('<div class="notice error"></div>'),T=t("<p></p>"),C=t('<button type="button" class="notice-dismiss"><span class="screen-reader-text">Dismiss this notice.</span></button>');return T.appendTo(D),C.appendTo(D),C.on("click",function(){D.animate({height:0},100,function(){D.css("height",""),T.html(),D.detach()})}),n[g].modal.attr("data-load-element","_parent").baldrick({request:window.location.href,before:function(e,o){t(document).trigger("uix.itemsubmit"),(k=n[g].modal.find('button[type="submit"]')).length&&(k.prop("disabled",!0),n[g].modal.addClass("processing")),D.detach()},callback:function(t){if(t.params.trigger.find('[type="submit"],button').prop("disabled",!1),n[g].modal.removeClass("processing"),n[g].data=t.rawData.data,"object"==typeof t.rawData)if(t.rawData.success)"string"==typeof t.rawData.data?t.rawData=t.rawData.data:"object"==typeof t.rawData.data?(t.rawData.data.redirect&&(window.location=t.rawData.data.redirect),n[g].modal.trigger("modal.complete")):"boolean"==typeof t.rawData.data&&!0===t.rawData.data&&k.length&&(n[g].flush=!1),r();else if(t.params.target=!1,"string"==typeof t.rawData.data){T.html(t.rawData.data),D.appendTo(n[g].body);var e=D.height();D.height(0).animate({height:e},100)}else r();else r()},complete:function(){t(document).trigger("uix.init")}}),n[g]},t.fn.uixModal=function(e){return e||(e={}),e=t.extend({},this.data(),e),t.uixModal(e,this)},window.addEventListener?(window.addEventListener("resize",l,!1),window.addEventListener("keypress",function(t){27===t.keyCode&&null!==a&&a.trigger("click")},!1)):window.attachEvent?window.attachEvent("onresize",l):window.onresize=l,t(document).on("click","[data-modal]:not(.uix-modal-closer)",function(e){return e.preventDefault(),t(this).uixModal()}),t(document).on("click",".uix-modal-closer",function(e){e.preventDefault(),t(window).trigger("close.modal")}),t(window).on("close.modal",function(t){r()}),t(window).on("modal.init",function(e){t("[data-modal][data-autoload]").each(function(){t(this).uixModal()})}),t(window).on("modal.open",function(e){t(document).trigger("uix.init")}),t(window).load(function(){t(window).trigger("modal.init")})}(jQuery);