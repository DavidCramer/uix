!function(i){var t,o,e,n=null,d={},a=[],s=[],l=function(){if(a.length||s.length){var i=a.length?a[a.length-1]:s[s.length-1],l=e.width(),c=e.height(),r=d[i].config.height,g=r,m=d[i].config.width,f=0,h=!1,p=!1;if(n&&t.addClass("has-uix-modal"),"string"==typeof m&&(m=parseInt(m),m=l/100*parseInt(m)),"string"==typeof r&&(r=parseInt(r),r=c/100*parseInt(r)),f=(c-r)/2.2,0>f&&(f=0),r+2*d[i].config.padding>c&&n&&(r=c-2*d[i].config.padding,g="100%",n&&n.css({paddingTop:d[i].config.padding,paddingBottom:d[i].config.padding}),p=!0),m+2*d[i].config.padding>=l&&(m="100%",n&&n.css({paddingLeft:d[i].config.padding,paddingRight:d[i].config.padding}),p=!0),!0===p&&(700>=l&&l>600?(n&&(r=c-2*d[i].config.padding),m=l,g=r-2*d[i].config.padding,m="100%",f=0,n&&n.css({padding:d[i].config.padding})):600>=l&&(n&&(r=c),m=l,g="100%",f=0,n&&n.css({padding:0}))),n&&n.is(":hidden")&&(h=!0,n.show()),d[i].header&&(n&&n.show(),r-=d[i].header.outerHeight(),d[i].closer.css({padding:d[i].header.outerHeight()/2-.5}),d[i].title.css({paddingRight:d[i].closer.outerWidth()})),d[i].footer&&(n&&n.show(),r-=d[i].footer.outerHeight()),n&&h===!0&&(n.hide(),h=!1),r!=g&&d[i].body.css({height:r}),d[i].modal.css({width:m}),d[i].config.sticky&&d[i].config.minimized){var u={},y=d[i].title.outerHeight()-d[i].modal.outerHeight();d[i].config.sticky.indexOf("bottom")>-1?u["margin-bottom"]=y:d[i].config.sticky.indexOf("top")>-1&&(u["margin-top"]=y),d[i].modal.css(u),d[i].config.sticky.length>=3&&(o.css("margin-"+d[i].config.sticky[0],d[i].title.outerHeight()),p?d[i].modal.css(d[i].config.sticky[1],0):d[i].modal.css(d[i].config.sticky[1],parseFloat(d[i].config.sticky[2])))}return n&&(d[i].modal.css({marginTop:f,height:g}),setTimeout(function(){d[i].modal.addClass("uix-animate")},10),n.fadeIn(d[i].config.speed)),d}},c=function(o){var e=i(o).data("modal"),s=0,l={};if(o&&d[e].config.sticky)return d[e].config.minimized?(d[e].config.minimized=!1,s=0):(d[e].config.minimized=!0,s=d[e].title.outerHeight()-d[e].modal.outerHeight()),d[e].config.sticky.indexOf("bottom")>-1?l["margin-bottom"]=s:d[e].config.sticky.indexOf("top")>-1&&(l["margin-top"]=s),void d[e].modal.stop().animate(l,d[e].config.speed);var c;a.length&&(c=a.pop(),d[c].modal.hasClass("uix-animate")&&!a.length?(d[c].modal.removeClass("uix-animate"),setTimeout(function(){d[c].modal.remove(),delete d[c]},500)):n&&d[c].modal.hide(0,function(){i(this).remove(),delete d[c]})),a.length?d[a[a.length-1]].modal.show():(n&&n.fadeOut(250,function(){i(this).remove(),n=null}),t.removeClass("has-uix-modal"))};i.uixModal=function(t,e){var r=i.extend(!0,{element:"div",height:550,width:620,padding:12,speed:250,content:conduitModal},t);r.trigger=e,n||r.sticky||(n=i("<div>",{"class":"uix-backdrop"}),r.focus||n.on("click",function(i){i.target==this&&c()}),o.append(n),n.hide());var g=r.element,m=r.modal;if(a.length&&a[a.length-1]!==m&&d[a[a.length-1]].modal.hide(),"undefined"==typeof d[m]?(r.sticky&&(r.sticky=r.sticky.split(" "),r.sticky.length<2&&(r.sticky=null),s.push(m)),d[m]={config:r,modal:i("<"+g+">",{id:m+"_uixModal",tabIndex:-1,"ariaLabelled-by":m+"_uixModalLable","class":"uix-modal-wrap"+(r.sticky?" uix-sticky-modal "+r.sticky[0]+"-"+r.sticky[1]:"")})},r.sticky||a.push(m)):(d[m].config=r,d[m].modal.empty()),r.animate&&n){var f=r.animate.split(" "),h=r.speed+"ms",p=r.animateEase?r.animateEase:"ease";1===f.length&&(f[1]=0),d[m].modal.css({transform:"translate("+f[0]+", "+f[1]+")","-web-kit-transition":"transform "+h+" "+p,"-moz-transition":"transform "+h+" "+p,transition:"transform "+h+" "+p})}if(d[m].body=i("<div>",{"class":"uix-modal-body",id:m+"_uixModalBody"}),d[m].content=i("<div>",{"class":"uix-modal-content",id:m+"_uixModalContent"}),d[m].content.css({margin:r.padding}),d[m].body.append(d[m].content).appendTo(d[m].modal),n?n.append(d[m].modal):d[m].modal.appendTo(i("body")),r.footer)if(d[m].footer=i("<div>",{"class":"uix-modal-footer",id:m+"_uixModalFooter"}),d[m].footer.css({padding:r.padding}),d[m].footer.appendTo(d[m].modal),"function"==typeof window[r.footer])d[m].footer.append(window[r.footer](r,d[m]));else if("string"==typeof r.footer)try{var u=i(r.footer);d[m].footer.html(u.html())}catch(y){d[m].footer.html(r.footer)}if(r.title){var w="prependTo";d[m].header=i("<div>",{"class":"uix-modal-title",id:m+"_uixModalTitle"}),d[m].closer=i("<a>",{href:"#close","class":"uix-modal-closer","data-dismiss":"modal","aria-hidden":"true",id:m+"_uixModalCloser"}).html("&times;"),d[m].title=i("<h3>",{"class":"modal-label",id:m+"_uixModalLable"}),d[m].title.html(r.title).appendTo(d[m].header),d[m].title.css({padding:r.padding}),d[m].title.append(d[m].closer),d[m].config.sticky?(d[m].config.minimized&&!0!==d[m].config.minimized&&(setTimeout(function(){d[m].title.trigger("click")},parseInt(d[m].config.minimized)),d[m].config.minimized=!1),d[m].closer.hide(),d[m].title.addClass("uix-modal-closer").data("modal",m).appendTo(d[m].header),d[m].config.sticky.indexOf("top")>-1&&(w="appendTo")):d[m].closer.data("modal",m).appendTo(d[m].header),d[m].header[w](d[m].modal)}if(d[m].modal.outerHeight(r.height),d[m].modal.outerWidth(r.width),r.content)if("function"==typeof r.content)d[m].content.append(r.content(r,d[m]));else if("string"==typeof r.content)try{var x=i(r.content);x.length?(d[m].content.append(x.detach()),x.show()):d[m].content.html(r.content)}catch(y){d[m].content.html(r.content)}return l(),i(window).trigger("modal.open"),d[m]},i.fn.uixModal=function(n){return t=i("html"),o=i("body"),e=i(window),n||(n={}),n=i.extend({},this.data(),n),i.uixModal(n,this)},window.addEventListener?(window.addEventListener("resize",l,!1),window.addEventListener("keypress",function(i){27===i.keyCode&&null!==n&&n.trigger("click")},!1)):window.attachEvent?window.attachEvent("onresize",l):window.onresize=l,i(document).on("click","[data-modal]:not(.uix-modal-closer)",function(t){t.preventDefault(),i(this).uixModal()}),i(document).on("click",".uix-modal-closer",function(t){t.preventDefault(),i(window).trigger("close.modal")}),i(window).on("close.modal",function(i){c()}),i(window).on("modal.init",function(t){i("[data-modal][data-autoload]").each(function(){i(this).uixModal()})}),i(window).load(function(){i(window).trigger("modal.init")})}(jQuery);