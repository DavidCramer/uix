var uix_item_control_modal,uix_item_control_modal_handler;!function(t){var o={};flush_current=!1,uix_item_control_modal=function(a){var i,n,r=t("#"+a.modal+"-tmpl"),e=Handlebars.compile(r.html()),l={};return o[a.modal]&&!1===flush_current?(l={config:o[a.modal].data("config")},i="add"):(o[a.modal]=!1,flush_current=!1,i="update",l=a.trigger.data("default")),(n=t(e(l))).find("[data-default]").each(function(){var o=t(this);o.val(o.data("default"))}),t("#"+a.modal+'_uixModal .uix-modal-footer [data-state="'+i+'"]').remove(),n},uix_item_control_modal_handler=function(n,r){var e,l=a(r.params.requestData.control,n.data);o[r.params.requestData.control+"-config"]?(e=o[r.params.requestData.control+"-config"],o[r.params.requestData.control+"-config"]=null,e.replaceWith(l)):(e=t("#"+r.params.requestData.control),l.appendTo(e)),i(t("#"+r.params.requestData.control))};var a=function(o,a){var i=t("#"+o+"-tmpl"),n=Handlebars.compile(i.html()),r=t(n(a));return r.data("config",a),t(document).trigger("uix.init"),r},i=function(o){var a;a=t(o||".uix-control-item");for(var i=0;i<a.length;i++){for(var n=t(a[i]),r=t("#"+n.prop("id")+"-control"),e=n.find(".uix-item"),l=[],c=0;c<e.length;c++){var u=t(e[c]);l.push(u.data("config"))}r.val(JSON.stringify(l)).trigger("change")}t(document).trigger("uix.save")};t(document).on("click",".uix-item-edit",function(){var a=t(this),i=a.closest(".uix-control-item").prop("id")+"-config",n=t('button[data-modal="'+i+'"]');o[i]=a.closest(".uix-item"),flush_current=!1,n.trigger("click")}),t(document).on("click",".uix-item-remove",function(){var a=t(this),n=a.closest(".uix-control-item"),r=n.prop("id")+"-config",e=(t('button[data-modal="'+r+'"]'),a.closest(".uix-item"));a.data("confirm")&&!confirm(a.data("confirm"))||(o[r]=null,e.fadeOut(200,function(){e.remove(),i(n)}))}),t(window).on("modals.closed",function(){flush_current=!0}),t(window).load(function(){t(document).on("uix.init",function(){t(".uix-control-item").not("._uix_item_init").each(function(){var o,i=t(this),n=t("#"+i.prop("id")+"-control");if(!i.hasClass("_uix_item_init")){i.addClass("_uix_item_init");try{o=JSON.parse(n.val())}catch(t){}if(i.addClass("_uix_item_init"),"object"==typeof o&&o.length)for(var r=0;r<o.length;r++){a(i.prop("id"),o[r]).appendTo(i)}i.removeClass("processing")}})})})}(jQuery);